CKEDITOR.plugins.add("pagebreak",{init:function(a){a.addCommand("pagebreak",CKEDITOR.plugins.pagebreakCmd);a.ui.addButton("PageBreak",{label:a.lang.pagebreak,command:"pagebreak"});var b=["{","background: url("+CKEDITOR.getUrl(this.path+"images/pagebreak.gif")+") no-repeat center center;","clear: both;","width:100%; _width:99.9%;","border-top: #999999 1px dotted;","border-bottom: #999999 1px dotted;","padding:0;","height: 5px;","cursor: default;","}"].join("").replace(/;/g," !important;");a.addCss("div.cke_pagebreak"+b);CKEDITOR.env.opera&&a.on("contentDom",function(){a.document.on("click",function(c){var d=c.data.getTarget();if(d.is("div")&&d.hasClass("cke_pagebreak")){a.getSelection().selectElement(d)}})})},afterInit:function(c){var b=c.lang.pagebreakAlt;var a=c.dataProcessor,d=a&&a.dataFilter,e=a&&a.htmlFilter;if(e){e.addRules({attributes:{"class":function(j,g){var i=j.replace("cke_pagebreak","");if(i!=j){var h=CKEDITOR.htmlParser.fragment.fromHtml('<span style="display: none;">&nbsp;</span>');g.children.length=0;g.add(h);var f=g.attributes;delete f["aria-label"];delete f.contenteditable;delete f.title}return i}}},5)}if(d){d.addRules({elements:{div:function(h){var g=h.attributes,i=g&&g.style,j=i&&h.children.length==1&&h.children[0],f=j&&(j.name=="span")&&j.attributes.style;if(f&&(/page-break-after\s*:\s*always/i).test(i)&&(/display\s*:\s*none/i).test(f)){g.contenteditable="false";g["class"]="cke_pagebreak";g["data-cke-display-name"]="pagebreak";g["aria-label"]=b;g.title=b;h.children.length=0}}}})}},requires:["fakeobjects"]});CKEDITOR.plugins.pagebreakCmd={exec:function(f){var c=f.lang.pagebreakAlt;var g=CKEDITOR.dom.element.createFromHtml('<div style="page-break-after: always;"contenteditable="false" title="'+c+'" aria-label="'+c+'" data-cke-display-name="pagebreak" class="cke_pagebreak"></div>',f.document);var a=f.getSelection().getRanges(true);f.fire("saveSnapshot");for(var b,d=a.length-1;d>=0;d--){b=a[d];if(d<a.length-1){g=g.clone(true)}b.splitBlock("p");b.insertNode(g);if(d==a.length-1){var e=g.getNext();b.moveToPosition(g,CKEDITOR.POSITION_AFTER_END);if(!e||e.type==CKEDITOR.NODE_ELEMENT&&!e.isEditable()){b.fixBlock(true,f.config.enterMode==CKEDITOR.ENTER_DIV?"div":"p")}b.select()}}f.fire("saveSnapshot")}};