CKEDITOR.dialog.add("checkspell",function(h){var e=CKEDITOR.tools.getNextNumber(),j="cke_frame_"+e,k="cke_data_"+e,c="cke_error_"+e,d,l=document.location.protocol||"http:",g=h.lang.spellCheck.notAvailable;var i='<textarea style="display: none" id="'+k+'" rows="10" cols="40"> </textarea><div id="'+c+'" style="display:none;color:red;font-size:16px;font-weight:bold;padding-top:160px;text-align:center;z-index:11;"></div><iframe src="" style="width:100%;background-color:#f1f1e3;" frameborder="0" name="'+j+'" id="'+j+'" allowtransparency="1"></iframe>';var b=h.config.wsc_customLoaderScript||(l+"//loader.webspellchecker.net/sproxy_fck/sproxy.php?plugin=fck2&customerid="+h.config.wsc_customerId+"&cmd=script&doc=wsc&schema=22");if(h.config.wsc_customLoaderScript){g+='<p style="color:#000;font-size:11px;font-weight: normal;text-align:center;padding-top:10px">'+h.lang.spellCheck.errorLoading.replace(/%s/g,h.config.wsc_customLoaderScript)+"</p>"}function a(n,o){var m=0;return function(){if(typeof(window.doSpell)=="function"){if(typeof(d)!="undefined"){window.clearInterval(d)}f(n)}else{if(m++==180){window._cancelOnError(o)}}}}window._cancelOnError=function(n){if(typeof(window.WSC_Error)=="undefined"){CKEDITOR.document.getById(j).setStyle("display","none");var o=CKEDITOR.document.getById(c);o.setStyle("display","block");o.setHtml(n||h.lang.spellCheck.notAvailable)}};function f(p){var o=new window._SP_FCK_LangCompare(),n=CKEDITOR.getUrl(h.plugins.wsc.path+"dialogs/"),m=n+"tmpFrameset.html";window.gFCKPluginName="wsc";o.setDefaulLangCode(h.config.defaultLanguage);window.doSpell({ctrl:k,lang:h.config.wsc_lang||o.getSPLangCode(h.langCode),intLang:h.config.wsc_uiLang||o.getSPLangCode(h.langCode),winType:j,onCancel:function(){p.hide()},onFinish:function(q){h.focus();p.getParentEditor().setData(q.value);p.hide()},staticFrame:m,framesetPath:m,iframePath:n+"ciframe.html",schemaURI:n+"wsc.css",userDictionaryName:h.config.wsc_userDictionaryName,customDictionaryName:h.config.wsc_customDictionaryIds&&h.config.wsc_customDictionaryIds.split(","),domainName:h.config.wsc_domainName});CKEDITOR.document.getById(c).setStyle("display","none");CKEDITOR.document.getById(j).setStyle("display","block")}return{title:h.config.wsc_dialogTitle||h.lang.spellCheck.title,minWidth:485,minHeight:380,buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var m=this.getContentElement("general","content").getElement();m.setHtml(i);m.getChild(2).setStyle("height",this._.contentSize.height+"px");if(typeof(window.doSpell)!="function"){CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:b}}))}var n=h.getData();CKEDITOR.document.getById(k).setValue(n);d=window.setInterval(a(this,g),250)},onHide:function(){window.ooo=undefined;window.int_framsetLoaded=undefined;window.framesetLoaded=undefined;window.is_window_opened=false},contents:[{id:"general",label:h.config.wsc_dialogTitle||h.lang.spellCheck.title,padding:0,elements:[{type:"html",id:"content",html:""}]}]}});CKEDITOR.dialog.on("resize",function(a){var e=a.data,b=e.dialog;if(b._.name=="checkspell"){var d=b.getContentElement("general","content").getElement(),c=d&&d.getChild(2);c&&c.setSize("height",e.height);c&&c.setSize("width",e.width)}});