(function(){var d="scaytcheck",c="";function a(k,j){var i=0,h;for(h in j){if(j[h]==k){i=1;break}}return i}var b=function(){var k=this;var h=function(){var p=k.config;var m={};m.srcNodeRef=k.document.getWindow().$.frameElement;m.assocApp="CKEDITOR."+CKEDITOR.version+"@"+CKEDITOR.revision;m.customerid=p.scayt_customerid||"1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2";m.customDictionaryIds=p.scayt_customDictionaryIds||"";m.userDictionaryName=p.scayt_userDictionaryName||"";m.sLang=p.scayt_sLang||"en_US";m.onLoad=function(){if(!(CKEDITOR.env.ie&&CKEDITOR.env.version<8)){this.addStyle(this.selectorCss(),"padding-bottom: 2px !important;")}if(k.focusManager.hasFocus&&!e.isControlRestored(k)){this.focus()}};m.onBeforeChange=function(){if(e.getScayt(k)&&!k.checkDirty()){setTimeout(function(){k.resetDirty()},0)}};var q=window.scayt_custom_params;if(typeof q=="object"){for(var o in q){m[o]=q[o]}}if(e.getControlId(k)){m.id=e.getControlId(k)}var s=new window.scayt(m);s.afterMarkupRemove.push(function(t){(new CKEDITOR.dom.element(t,s.document)).mergeSiblings()});var n=e.instances[k.name];if(n){s.sLang=n.sLang;s.option(n.option());s.paused=n.paused}e.instances[k.name]=s;try{s.setDisabled(e.isPaused(k)===false)}catch(r){}k.fire("showScaytState")};k.on("contentDom",h);k.on("contentDomUnload",function(){var m=CKEDITOR.document.getElementsByTag("script"),q=/^dojoIoScript(\d+)$/i,o=/^https?:\/\/svc\.webspellchecker\.net\/spellcheck\/script\/ssrv\.cgi/i;for(var p=0;p<m.count();p++){var n=m.getItem(p),s=n.getId(),r=n.getAttribute("src");if(s&&r&&s.match(q)&&r.match(o)){n.remove()}}});k.on("beforeCommandExec",function(n){if((n.data.name=="source"||n.data.name=="newpage")&&k.mode=="wysiwyg"){var m=e.getScayt(k);if(m){e.setPaused(k,!m.disabled);e.setControlId(k,m.id);m.destroy(true);delete e.instances[k.name]}}else{if(n.data.name=="source"&&k.mode=="source"){e.markControlRestore(k)}}});k.on("afterCommandExec",function(m){if(!e.isScaytEnabled(k)){return}if(k.mode=="wysiwyg"&&(m.data.name=="undo"||m.data.name=="redo")){window.setTimeout(function(){e.getScayt(k).refresh()},10)}});k.on("destroy",function(o){var n=o.editor,m=e.getScayt(n);if(!m){return}delete e.instances[n.name];e.setControlId(n,m.id);m.destroy(true)});k.on("afterSetData",function(){if(e.isScaytEnabled(k)){window.setTimeout(function(){var m=e.getScayt(k);m&&m.refresh()},10)}});k.on("insertElement",function(){var m=e.getScayt(k);if(e.isScaytEnabled(k)){if(CKEDITOR.env.ie){k.getSelection().unlock(true)}window.setTimeout(function(){m.focus();m.refresh()},10)}},this,null,50);k.on("insertHtml",function(){var m=e.getScayt(k);if(e.isScaytEnabled(k)){if(CKEDITOR.env.ie){k.getSelection().unlock(true)}window.setTimeout(function(){m.focus();m.refresh()},10)}},this,null,50);k.on("scaytDialog",function(m){m.data.djConfig=window.djConfig;m.data.scayt_control=e.getScayt(k);m.data.tab=c;m.data.scayt=window.scayt});var j=k.dataProcessor,l=j&&j.htmlFilter;if(l){l.addRules({elements:{span:function(m){if(m.attributes["data-scayt_word"]&&m.attributes["data-scaytid"]){delete m.name;return m}}}})}var i=CKEDITOR.plugins.undo.Image.prototype;i.equals=CKEDITOR.tools.override(i.equals,function(m){return function(q){var p=this.contents,r=q.contents;var o=e.getScayt(this.editor);if(o&&e.isScaytReady(this.editor)){this.contents=o.reset(p)||"";q.contents=o.reset(r)||""}var n=m.apply(this,arguments);this.contents=p;q.contents=r;return n}});if(k.document){h()}};CKEDITOR.plugins.scayt={engineLoaded:false,instances:{},controlInfo:{},setControlInfo:function(i,j){if(i&&i.name&&typeof(this.controlInfo[i.name])!="object"){this.controlInfo[i.name]={}}for(var h in j){this.controlInfo[i.name][h]=j[h]}},isControlRestored:function(h){if(h&&h.name&&this.controlInfo[h.name]){return this.controlInfo[h.name].restored}return false},markControlRestore:function(h){this.setControlInfo(h,{restored:true})},setControlId:function(h,i){this.setControlInfo(h,{id:i})},getControlId:function(h){if(h&&h.name&&this.controlInfo[h.name]&&this.controlInfo[h.name].id){return this.controlInfo[h.name].id}return null},setPaused:function(i,h){this.setControlInfo(i,{paused:h})},isPaused:function(h){if(h&&h.name&&this.controlInfo[h.name]){return this.controlInfo[h.name].paused}return undefined},getScayt:function(h){return this.instances[h.name]},isScaytReady:function(h){return this.engineLoaded===true&&"undefined"!==typeof window.scayt&&this.getScayt(h)},isScaytEnabled:function(i){var h=this.getScayt(i);return(h)?h.disabled===false:false},getUiTabs:function(k){var l=[];var h=k.config.scayt_uiTabs||"1,1,1";h=h.split(",");h[3]="1";for(var j=0;j<4;j++){l[j]=(typeof window.scayt!="undefined"&&typeof window.scayt.uiTags!="undefined")?(parseInt(h[j],10)&&window.scayt.uiTags[j]):parseInt(h[j],10)}return l},loadEngine:function(i){if(CKEDITOR.env.gecko&&CKEDITOR.env.version<10900||CKEDITOR.env.opera||CKEDITOR.env.air){return i.fire("showScaytState")}if(this.engineLoaded===true){return b.apply(i)}else{if(this.engineLoaded==-1){return CKEDITOR.on("scaytReady",function(){b.apply(i)})}}CKEDITOR.on("scaytReady",b,i);CKEDITOR.on("scaytReady",function(){this.engineLoaded=true},this,null,0);this.engineLoaded=-1;var l=document.location.protocol;l=l.search(/https?:/)!=-1?l:"http:";var j="svc.webspellchecker.net/scayt26/loader__base.js";var h=i.config.scayt_srcUrl||(l+"//"+j);var k=e.parseUrl(h).path+"/";if(window.scayt==undefined){CKEDITOR._djScaytConfig={baseUrl:k,addOnLoad:[function(){CKEDITOR.fireOnce("scaytReady")}],isDebug:false};CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",async:"true",src:h}}))}else{CKEDITOR.fireOnce("scaytReady")}return null},parseUrl:function(i){var h;if(i.match&&(h=i.match(/(.*)[\/\\](.*?\.\w+)$/))){return{path:h[1],file:h[2]}}else{return i}}};var e=CKEDITOR.plugins.scayt;var f=function(l,h,m,k,n,j,i){l.addCommand(k,n);l.addMenuItem(k,{label:m,command:k,group:j,order:i})};var g={preserveState:true,editorFocus:false,canUndo:false,exec:function(i){if(e.isScaytReady(i)){var h=e.isScaytEnabled(i);this.setState(h?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_ON);var j=e.getScayt(i);j.focus();j.setDisabled(h)}else{if(!i.config.scayt_autoStartup&&e.engineLoaded>=0){this.setState(CKEDITOR.TRISTATE_DISABLED);e.loadEngine(i)}}}};CKEDITOR.plugins.add("scayt",{requires:["menubutton"],beforeInit:function(j){var i=j.config.scayt_contextMenuItemsOrder||"suggest|moresuggest|control",h="";i=i.split("|");if(i&&i.length){for(var k=0;k<i.length;k++){h+="scayt_"+i[k]+(i.length!=parseInt(k,10)+1?",":"")}}j.config.menu_groups=h+","+j.config.menu_groups},init:function(l){var h=l.dataProcessor&&l.dataProcessor.dataFilter;var r={elements:{span:function(t){var s=t.attributes;if(s&&s["data-scaytid"]){delete t.name}}}};h&&h.addRules(r);var m={},p={};var k=l.addCommand(d,g);CKEDITOR.dialog.add(d,CKEDITOR.getUrl(this.path+"dialogs/options.js"));var q=e.getUiTabs(l);var j="scaytButton";l.addMenuGroup(j);var n={};var i=l.lang.scayt;n.scaytToggle={label:i.enable,command:d,group:j};if(q[0]==1){n.scaytOptions={label:i.options,group:j,onClick:function(){c="options";l.openDialog(d)}}}if(q[1]==1){n.scaytLangs={label:i.langs,group:j,onClick:function(){c="langs";l.openDialog(d)}}}if(q[2]==1){n.scaytDict={label:i.dictionariesTab,group:j,onClick:function(){c="dictionaries";l.openDialog(d)}}}n.scaytAbout={label:l.lang.scayt.about,group:j,onClick:function(){c="about";l.openDialog(d)}};l.addMenuItems(n);l.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:i.title,title:CKEDITOR.env.opera?i.opera_title:i.title,className:"cke_button_scayt",modes:{wysiwyg:1},onRender:function(){k.on("state",function(){this.setState(k.state)},this)},onMenu:function(){var s=e.isScaytEnabled(l);l.getMenuItem("scaytToggle").label=i[s?"disable":"enable"];var t=e.getUiTabs(l);return{scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:s&&t[0]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:s&&t[1]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:s&&t[2]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:s&&t[3]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}});if(l.contextMenu&&l.addMenuItems){l.contextMenu.addListener(function(v,L){if(!e.isScaytEnabled(l)||L.getRanges()[0].checkReadOnly()){return null}var z=e.getScayt(l),C=z.getScaytNode();if(!C){return null}var I=z.getWord(C);if(!I){return null}var y=z.getLang(),J={},G=window.scayt.getSuggestion(I,y);if(!G||!G.length){return null}for(var D in m){delete l._.menuItems[D];delete l._.commands[D]}for(D in p){delete l._.menuItems[D];delete l._.commands[D]}m={};p={};var u=l.config.scayt_moreSuggestions||"on";var w=false;var x=l.config.scayt_maxSuggestions;(typeof x!="number")&&(x=5);!x&&(x=G.length);var t=l.config.scayt_contextCommands||"all";t=t.split("|");for(var H=0,E=G.length;H<E;H+=1){var s="scayt_suggestion_"+G[H].replace(" ","_");var F=(function(N,M){return{exec:function(){z.replace(N,M)}}})(C,G[H]);if(H<x){f(l,"button_"+s,G[H],s,F,"scayt_suggest",H+1);J[s]=CKEDITOR.TRISTATE_OFF;p[s]=CKEDITOR.TRISTATE_OFF}else{if(u=="on"){f(l,"button_"+s,G[H],s,F,"scayt_moresuggest",H+1);m[s]=CKEDITOR.TRISTATE_OFF;w=true}}}if(w){l.addMenuItem("scayt_moresuggest",{label:i.moreSuggestions,group:"scayt_moresuggest",order:10,getItems:function(){return m}});p.scayt_moresuggest=CKEDITOR.TRISTATE_OFF}if(a("all",t)||a("ignore",t)){var A={exec:function(){z.ignore(C)}};f(l,"ignore",i.ignore,"scayt_ignore",A,"scayt_control",1);p.scayt_ignore=CKEDITOR.TRISTATE_OFF}if(a("all",t)||a("ignoreall",t)){var K={exec:function(){z.ignoreAll(C)}};f(l,"ignore_all",i.ignoreAll,"scayt_ignore_all",K,"scayt_control",2);p.scayt_ignore_all=CKEDITOR.TRISTATE_OFF}if(a("all",t)||a("add",t)){var B={exec:function(){window.scayt.addWordToUserDictionary(C)}};f(l,"add_word",i.addWord,"scayt_add_word",B,"scayt_control",3);p.scayt_add_word=CKEDITOR.TRISTATE_OFF}if(z.fireOnContextMenu){z.fireOnContextMenu(l)}return p})}var o=function(){l.removeListener("showScaytState",o);if(!CKEDITOR.env.opera&&!CKEDITOR.env.air){k.setState(e.isScaytEnabled(l)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)}else{k.setState(CKEDITOR.TRISTATE_DISABLED)}};l.on("showScaytState",o);if(CKEDITOR.env.opera||CKEDITOR.env.air){l.on("instanceReady",function(){o()})}if(l.config.scayt_autoStartup){l.on("instanceReady",function(){e.loadEngine(l)})}},afterInit:function(j){var i,h=function(k){if(k.hasAttribute("data-scaytid")){return false}};if(j._.elementsPath&&(i=j._.elementsPath.filters)){i.push(h)}j.addRemoveFormatFilter&&j.addRemoveFormatFilter(h)}})})();