CKEDITOR.plugins.add("iframedialog",{requires:["dialog"],onLoad:function(){CKEDITOR.dialog.addIframe=function(c,h,a,b,k,d,j){var g={type:"iframe",src:a,width:"100%",height:"100%"};if(typeof(d)=="function"){g.onContentLoad=d}else{g.onContentLoad=function(){var m=this.getElement(),n=m.$.contentWindow;if(n.onDialogEvent){var l=this.getDialog(),i=function(o){return n.onDialogEvent(o)};l.on("ok",i);l.on("cancel",i);l.on("resize",i);l.on("hide",function(o){l.removeListener("ok",i);l.removeListener("cancel",i);l.removeListener("resize",i);o.removeListener()});n.onDialogEvent({name:"load",sender:this,editor:l._.editor})}}}var e={title:h,minWidth:b,minHeight:k,contents:[{id:"iframe",label:h,expand:true,elements:[g]}]};for(var f in j){e[f]=j[f]}this.add(c,function(){return e})};(function(){var a=function(g,c,d){if(arguments.length<3){return}var j=(this._||(this._={})),b=c.onContentLoad&&CKEDITOR.tools.bind(c.onContentLoad,this),i=CKEDITOR.tools.cssLength(c.width),f=CKEDITOR.tools.cssLength(c.height);j.frameId=CKEDITOR.tools.getNextId()+"_iframe";g.on("load",function(){var k=CKEDITOR.document.getById(j.frameId),l=k.getParent();l.setStyles({width:i,height:f})});var e={src:"%2",id:j.frameId,frameborder:0,allowtransparency:true};var h=[];if(typeof(c.onContentLoad)=="function"){e.onload="CKEDITOR.tools.callFunction(%1);"}CKEDITOR.ui.dialog.uiElement.call(this,g,c,h,"iframe",{width:i,height:f},e,"");d.push('<div style="width:'+i+";height:"+f+';" id="'+this.domId+'"></div>');h=h.join("");g.on("show",function(){var m=CKEDITOR.document.getById(j.frameId),n=m.getParent(),l=CKEDITOR.tools.addFunction(b),k=h.replace("%1",l).replace("%2",CKEDITOR.tools.htmlEncode(c.src));n.setHtml(k)})};a.prototype=new CKEDITOR.ui.dialog.uiElement;CKEDITOR.dialog.addUIElement("iframe",{build:function(c,d,b){return new a(c,d,b)}})})()}});