(function(){CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(f){this._={elementNames:[],attributeNames:[],elements:{$length:0},attributes:{$length:0}};if(f){this.addRules(f,10)}},proto:{addRules:function(g,f){if(typeof f!="number"){f=10}a(this._.elementNames,g.elementNames,f);a(this._.attributeNames,g.attributeNames,f);e(this._.elements,g.elements,f);e(this._.attributes,g.attributes,f);this._.text=d(this._.text,g.text,f)||this._.text;this._.comment=d(this._.comment,g.comment,f)||this._.comment;this._.root=d(this._.root,g.root,f)||this._.root},onElementName:function(f){return c(f,this._.elementNames)},onAttributeName:function(f){return c(f,this._.attributeNames)},onText:function(g){var f=this._.text;return f?f.filter(g):g},onComment:function(g,h){var f=this._.comment;return f?f.filter(g,h):g},onFragment:function(f){var g=this._.root;return g?g.filter(f):f},onElement:function(h){var k=[this._.elements["^"],this._.elements[h.name],this._.elements.$],j,f;for(var g=0;g<3;g++){j=k[g];if(j){f=j.filter(h,this);if(f===false){return null}if(f&&f!=h){return this.onNode(f)}if(h.parent&&!h.name){break}}}return h},onNode:function(g){var f=g.type;return f==CKEDITOR.NODE_ELEMENT?this.onElement(g):f==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(g.value)):f==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(g.value)):null},onAttribute:function(h,g,j){var i=this._.attributes[g];if(i){var f=i.filter(j,h,this);if(f===false){return false}if(typeof f!="undefined"){return f}}return j}}});function c(f,j){for(var g=0;f&&g<j.length;g++){var h=j[g];f=f.replace(h[0],h[1])}return f}function a(n,f,l){if(typeof f=="function"){f=[f]}var k,h,o=n.length,g=f&&f.length;if(g){for(k=0;k<o&&n[k].pri<l;k++){}for(h=g-1;h>=0;h--){var m=f[h];if(m){m.pri=l;n.splice(k,0,m)}}}}function e(i,f,h){if(f){for(var g in f){var j=i[g];i[g]=d(j,f[g],h);if(!j){i.$length++}}}}function d(h,g,f){if(g){g.pri=f;if(h){if(!h.splice){if(h.pri>f){h=[g,h]}else{h=[h,g]}h.filter=b}else{a(h,g,f)}return h}else{g.filter=g;return g}}}function b(h){var l=h.type||h instanceof CKEDITOR.htmlParser.fragment;for(var g=0;g<this.length;g++){if(l){var m=h.type,k=h.name}var j=this[g],f=j.apply(window,arguments);if(f===false){return f}if(l){if(f&&(f.name!=k||f.type!=m)){return f}}else{if(typeof f!="string"){return f}}f!=undefined&&(h=f)}return h}})();