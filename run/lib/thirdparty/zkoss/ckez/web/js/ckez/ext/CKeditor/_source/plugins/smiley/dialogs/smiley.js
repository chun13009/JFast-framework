CKEDITOR.dialog.add("smiley",function(j){var d=j.config,b=j.lang.smiley,l=d.smiley_images,e=d.smiley_columns||8,g;var k;var m=function(i){var r=i.data.getTarget(),q=r.getName();if(q=="a"){r=r.getChild(0)}else{if(q!="img"){return}}var t=r.getAttribute("cke_src"),s=r.getAttribute("title");var p=j.document.createElement("img",{attributes:{src:t,"data-cke-saved-src":t,title:s,alt:s,width:r.$.width,height:r.$.height}});j.insertElement(p);k.hide();i.data.preventDefault()};var f=CKEDITOR.tools.addFunction(function(p,i){p=new CKEDITOR.dom.event(p);i=new CKEDITOR.dom.element(i);var r,q;var t=p.getKeystroke(),s=j.lang.dir=="rtl";switch(t){case 38:if((r=i.getParent().getParent().getPrevious())){q=r.getChild([i.getParent().getIndex(),0]);q.focus()}p.preventDefault();break;case 40:if((r=i.getParent().getParent().getNext())){q=r.getChild([i.getParent().getIndex(),0]);if(q){q.focus()}}p.preventDefault();break;case 32:m({data:p});p.preventDefault();break;case s?37:39:case 9:if((r=i.getParent().getNext())){q=r.getChild(0);q.focus();p.preventDefault(true)}else{if((r=i.getParent().getParent().getNext())){q=r.getChild([0,0]);if(q){q.focus()}p.preventDefault(true)}}break;case s?39:37:case CKEDITOR.SHIFT+9:if((r=i.getParent().getPrevious())){q=r.getChild(0);q.focus();p.preventDefault(true)}else{if((r=i.getParent().getParent().getPrevious())){q=r.getLast().getChild(0);q.focus();p.preventDefault(true)}}break;default:return}});var a=CKEDITOR.tools.getNextId()+"_smiley_emtions_label";var h=['<div><span id="'+a+'" class="cke_voice_label">'+b.options+"</span>",'<table role="listbox" aria-labelledby="'+a+'" style="width:100%;height:100%" cellspacing="2" cellpadding="2"',CKEDITOR.env.ie&&CKEDITOR.env.quirks?' style="position:absolute;"':"","><tbody>"];var o=l.length;for(g=0;g<o;g++){if(g%e===0){h.push("<tr>")}var c="cke_smile_label_"+g+"_"+CKEDITOR.tools.getNextNumber();h.push('<td class="cke_dark_background cke_centered" style="vertical-align: middle;"><a href="javascript:void(0)" role="option"',' aria-posinset="'+(g+1)+'"',' aria-setsize="'+o+'"',' aria-labelledby="'+c+'"',' class="cke_smile cke_hand" tabindex="-1" onkeydown="CKEDITOR.tools.callFunction( ',f,', event, this );">','<img class="cke_hand" title="',d.smiley_descriptions[g],'" cke_src="',CKEDITOR.tools.htmlEncode(d.smiley_path+l[g]),'" alt="',d.smiley_descriptions[g],'"',' src="',CKEDITOR.tools.htmlEncode(d.smiley_path+l[g]),'"',(CKEDITOR.env.ie?" onload=\"this.setAttribute('width', 2); this.removeAttribute('width');\" ":""),'><span id="'+c+'" class="cke_voice_label">'+d.smiley_descriptions[g]+"</span></a>","</td>");if(g%e==e-1){h.push("</tr>")}}if(g<e-1){for(;g<e-1;g++){h.push("<td></td>")}h.push("</tr>")}h.push("</tbody></table></div>");var n={type:"html",id:"smileySelector",html:h.join(""),onLoad:function(i){k=i.sender},focus:function(){var i=this;setTimeout(function(){var p=i.getElement().getElementsByTag("a").getItem(0);p.focus()},0)},onClick:m,style:"width: 100%; border-collapse: separate;"};return{title:j.lang.smiley.title,minWidth:270,minHeight:120,contents:[{id:"tab1",label:"",title:"",expand:true,padding:0,elements:[n]}],buttons:[CKEDITOR.dialog.cancelButton]}});